"use strict";!function(c){var i=new Promise(function(i,t){c("header").load("index.html .header-bar",function(){i("header加载完成")})}),t=new Promise(function(i,t){c("footer").load("index.html .footer-bottom",function(){i("footer加载完成")})});function o(i,t,n){var e=new Date;e.setDate(e.getDate()+n),document.cookie=i+"="+encodeURIComponent(t)+";expires="+e}function n(i){for(var t=decodeURIComponent(document.cookie).split("; "),n=0;n<t.length;n++){var e=t[n].split("=");if(e[0]==i)return e[1]}}if(Promise.all([i,t]).then(function(){c.getScript("http://10.31.163.69/shop/src/script/js/headerlogin.js")}),n("cookiesid")&&n("cookienum")){var e=n("cookiesid").split(","),a=n("cookienum").split(",");c.each(e,function(i,t){!function(e,o){c.ajax({url:"http://10.31.163.69/shop/php/indexdata.php",dataType:"json"}).done(function(i){c.each(i,function(i,t){if(e==t.sid){console.log(e);var n=c(".item-hide:hidden").clone(!0,!0);n.find(".cart-information1-pic").find("img").attr("src",t.url),n.find(".cart-information1-pic").find("img").attr("sid",t.sid),n.find(".cart-information1-info-name").find("a").html(t.title),n.find(".now-price").find("strong").html(t.price),n.find(".last-price").find("b").html(t.oprice),n.find(".quantity").find("input").val(o),n.find(".cart-sum1-price").find("strong").html((t.price*o).toFixed(2)),n.css("display","block"),c(".cart-content-middle-item table tbody").append(n),r()}})})}(e[i],a[i])})}function r(){var n=0,e=0;c(".item-hide:visible").each(function(i,t){c(t).find(".quantity input")&&(n+=parseInt(c(t).find(".quantity").find("input").val()),e+=parseFloat(c(t).find(".cart-sum1-price").find("strong").html()))}),c(".cart-money-num").find("b").html(n),c(".cart-money-sum").html("￥"+e.toFixed(2))}n("cookiesid")&&n("cookienum")?(c(".hiden-car").hide(),c(".cart-content").show()):(c(".hiden-car").show(),c(".cart-content").hide()),c(".allsel").on("change",function(){c(".goods-item:visible").find(":checkbox").prop("checked",c(this).prop("checked")),c(".allsel").prop("checked",c(this).prop("checked")),r()});var s=c(".goods-item:visible").find(":checkbox");function d(i){return(parseFloat(i.parents(".item-hide").find(".now-price").find("strong").html())*parseInt(i.parents(".item-hide").find(".quantity input").val())).toFixed(2)}c(".item-list").on("change",s,function(){c(".goods-item:visible").find("input:checkbox").length==c(".goods-item:visible").find("input:checked").size()?c(".allsel").prop("checked",!0):c(".allsel").prop("checked",!1),r()}),c(".quantity .quantity-r-a").on("click",function(){var i=c(this).parents(".cart-num1").find("input").val();99<=++i&&(i=99),c(this).parents(".cart-num1").find("input").val(i),c(this).parents(".item-hide").find(".cart-sum1 .cart-sum1-price").find("strong").html(d(c(this))),r(),u(c(this))}),c(".quantity .quantity-l-a").on("click",function(){var i=c(this).parents(".cart-num1").find("input").val();--i<=1&&(i=1),c(this).parents(".cart-num1").find("input").val(i),c(this).parents(".item-hide").find(".cart-sum1 .cart-sum1-price").find("strong").html(d(c(this))),r(),u(c(this))}),c(".quantity input").on("input",function(){var i=parseInt(c(this).val());/^\d+$/g.test(i)?99<=i?c(this).val(99):i<=0?c(this).val(1):c(this).val(i):c(this).val(1),c(this).parents(".item-hide").find(".cart-sum1 .cart-sum1-price").find("strong").html(d(c(this))),r(),u(c(this))});var h=[],f=[];function p(){n("cookiesid")&&n("cookienum")&&(h=n("cookiesid").split(","),f=n("cookienum").split(","))}function u(i){p();var t=i.parents(".item-hide").find("img").attr("sid");f[c.inArray(t,h)]=i.parents(".item-hide").find(".quantity input").val(),o("cookienum",f.toString(),7)}function l(n,i){var e=-1;c.each(i,function(i,t){n==t&&(e=i)}),i.splice(e,1),f.splice(e,1),o("cookiesid",i.toString(),7),o("cookienum",f.toString(),7)}c(".item-hide").on("click",".cart-operation1 a",function(i){p(),confirm("你确定要删除吗？")&&c(this).first().parents(".item-hide").remove(),l(c(this).first().parents(".item-hide").find("img").attr("sid"),h),r()}),c(".operation a:first").on("click",function(){p(),confirm("你确定要全部删除吗？")&&(c(".goods-item:visible").each(function(){c(this).find("input:checkbox").is(":checked")&&(c(this).remove(),l(c(this).find("img").attr("sid"),h))}),r())})}(jQuery);